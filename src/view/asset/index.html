<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Colnago</title>
    <style>
        * {
            border: 0px;
            margin: 0px;
            padding: 0px;
            --color-bg: rgb(107, 214, 228);
        }

        a {
            text-decoration: none;
            color: #0066cc;
        }

        header {
            background-color: var(--color-bg);
            background-image: linear-gradient(120deg, #96e6a1 0%, #d4fc79 100%);
            height: 3rem;
            border-bottom: #d2d4d4 1px solid;
        }

        header p {
            padding: 0.5rem;
            font-size: 1.5rem;
            color: #fafafa;
            font-weight: bold;
        }

        main {
            box-sizing: border-box;
            width: 100fr;
            height: 100%;
            min-height: calc(100vh - 3rem);
            background-color: #fafafa;
            color: #1d1d1f;
        }

        footer {
            border-top: rgb(103, 127, 233) 1px solid;
            height: 10rem;
            background-color: #fafafa;
            display: flex;
            justify-content: center;
            align-items: center;
            /* flex-wrap: wrap; */
        }

        footer p {
            color: var(--color-bg);
            width: 100%;
            text-align: center;
        }

        footer a {
            text-decoration: none;
            color: var(--color-bg);
        }

        main .content {
            width: 90%;
            margin-left: 5%;
            padding-top: 0.4rem;
            min-height: 100vh;
            color: #1d1d1f;
            display: flex;
            justify-content: center;
        }

        .content .box {
            flex: 4;
            width: 96%;
            height: auto;
            min-height: 5rem;
            /* border: rgb(192, 158, 64) 1px solid; */
            padding: 0.5rem;
            margin-bottom: 3rem;
            border-radius: 0.5rem;
        }

        .box li {
            list-style: none;
        }

        .Card {
            background-color: #fafafa;
            color: #1d1d1f;
            padding: 1rem;
            font-size: 1rem;
            margin-top: 1rem;
            border-radius: 0.5rem;
            position: relative;
            box-shadow: #9b9b9b 0px 0px 5px;
        }

        .Card p {
            font-size: 1rem;
            padding: 0.5rem 0rem;
            word-wrap: break-word;
        }

        .Card ul {
            border-radius: 0.5rem;
        }

        .Card ul li {
            border-bottom: 1px rgb(113, 113, 121) solid;
            padding-top: 0.5rem;
            padding-bottom: 0.5rem;
        }

        .Card h2 {
            margin-bottom: 1rem;
        }

        .Card form textarea {
            height: auto;
            min-height: 8rem;
            background-color: rgb(245, 245, 245);
            width: 100%;
            padding: 0.5rem;
            box-sizing: border-box;
            word-wrap: break-word;
            font-size: 1rem;
            border: 1px rgb(21, 156, 21) dashed;
            margin-top: 0.5rem;
            padding-left: 0.5rem;
        }

        .Card button {
            width: 4rem;
            height: 2rem;
            cursor: pointer;
            font-size: 1.1rem;
            background-color: rgb(32, 32, 32);
            border-radius: 0.4rem;
            margin-top: 1rem;
            color: #fafafa;
        }

        .Card button:hover {
            background-color: rgb(248, 80, 80);
            color: aliceblue;
        }

        .change_box {
            display: flex;
            margin-top: 0.5rem;
            justify-content: space-evenly;
        }

        .resize-vertical {
            resize: none;
            overflow: hidden;
        }

        li textarea {
            width: 100%;
            outline: none;
            min-height: 10rem;
            word-wrap: break-word;
            font-size: 1.2rem;
            box-sizing: border-box;
        }

        li p {
            text-align: right;
        }
    </style>

</head>

<body>
    <header>
        <a href="/">
            <p>WriterHub</p>
        </a>
    </header>
    <main>
        <div class="content">
            <div class="box">
                <p>
                    <em>WriterHub</em> open blog platform
                </p>

                <div class="Card">
                    <h2>blog world</h2>
                    <p>tour sharing from visitors</p>
                    <ul class="GET">
                        {% for post in list %}
                        <li>
                            <textarea readonly class="resize-vertical">
{{ post.date }}
{{ post.text }}
                            </textarea>
                            <p><a href="/detail/{{ post.id }}">visiting detail</a></p>
                        </li>
                        {% endfor %}
                    </ul>
                    <script>
                        let search = window.location.search;
                        if (search.length > 0 && search[0] == '?') {
                            search = search.substr(1, search.length - 1);
                        }
                        search = search.split("&&");
                        let map = new Map();
                        search.forEach((v, i) => {
                            let pair = v.split("=");
                            map.set(pair[0], pair[1]);
                        });
                        console.log(map);
                        let page = 1;
                        if (map.has("page")) {
                            const n = Number(map.get("page"));
                            page = n <= 0 ? 1 : n;
                        }
                        document.write(`<div class="change_box">
                                            <a href="/?page=${page-1}">before</a>
                                            ${page} 
                                            <a href="/?page=${page+1}">after</a>
                                        </div>`);
                    </script>
                </div>
                <div class="Card">
                    <h2>talk about your stroy</h2>
                    <p>share it to the world</p>
                    <form id="form_POST">
                        <p>text content</p>
                        <textarea placeholder="text content"></textarea><br />
                        <button type="submit" id="submit_POST">submit</button>
                    </form>
                </div>
            </div>
        </div>
    </main>
    <footer>
        <p>Â© 2022 crust-hub, Inc.</p>
        <p><a href="https://github.com/crust-hub" target="_blank">@Github</a></p>
    </footer>
</body>
<script>
    const Post = {
        post(post) {
            fetch('/post/' + post.id, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(post),
                })
                .then(response => response.json())
                .then(data => {
                    console.log('Success:', data);
                    location.reload();
                })
                .catch((error) => {
                    console.error('Error:', error);
                });
        }
    };
    let buttons = [];
    ["POST"].forEach(item => {
        buttons.push(document.getElementById("submit_" + item));
    });

    //POST
    buttons[0].onclick = function (e) {
        e.preventDefault();
        let inputs = document.getElementById("form_POST").getElementsByTagName("textarea");
        let post = {
            id: 0,
            text: inputs[0].value
        };
        Post.post(post);
    }
</script>

</html>